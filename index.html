<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Architecture of Ideas</title>
    <link rel="icon" type="image/png" href="favicon.png" />

    <meta property="og:title" content="Architecture of Ideas" />
    <meta property="og:description" content="Strategy, Product, Brand." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://oscarvalledor.com" />
    <meta property="og:image" content="https://oscarvalledor.com/og-image.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Architecture of Ideas" />
    <meta name="twitter:description" content="Strategy, Product, Brand." />
    <meta name="twitter:image" content="https://oscarvalledor.com/og-image.png" />

    <link rel="stylesheet" href="style.css" />

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q5J88H59YB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-Q5J88H59YB');
    </script>
  </head>
  <body>

    <div class="page">

      <div class="top">
        <span>Oscar Valledor - <em>Architecture of Ideas</em></span>
      </div>
      <span class="view-title"></span>

      <nav class="site-nav">
        <a href="#" data-view="now">Now</a>
        <a href="#" data-view="projects">Work</a>
        <a href="#" data-view="about">About</a>
        <a href="#" data-view="essays">Essays</a>
        <a href="#" data-view="thoughts">Thoughts</a>
        <a href="#" data-view="books">Books</a>
        <a href="#" data-view="music">Music</a>
        <a href="#" data-view="links">Links</a>
        <a href="#" data-view="contact">Contact</a>
      </nav>

      <div class="bottom">
        <div class="bottom-left">
          <div class="bottom-meta">
            <a href="#" data-view="colophon" class="copyright">© 2026</a>
            <div id="present" aria-live="polite">
              <span id="present-city"></span>
              <span id="present-coords"></span>
              <span id="present-time"></span>
              <span id="present-weather"></span>
              <span id="present-moon"></span>
            </div>
          </div>
        </div>
      </div>

      <!-- Books -->
      <div id="books-view" class="overlay-view">
        <div class="view-list"></div>
        <div class="view-footer">
          <span id="books-count"></span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Projects -->
      <div id="projects-view" class="overlay-view">
        <div class="view-list"></div>
        <div class="view-footer">
          <span>The garden.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Writing -->
      <div id="essays-view" class="overlay-view">
        <div class="view-list"></div>
        <div class="view-footer">
          <span>Long form.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Contact -->
      <div id="contact-view" class="overlay-view">
        <div class="view-list">
          <p><a href="https://instagram.com/oscarvalledor" target="_blank" rel="noopener noreferrer">Instagram</a></p>
          <p><a href="https://www.linkedin.com/in/oscarvalledor/" target="_blank" rel="noopener noreferrer">LinkedIn</a></p>
          <p><a href="mailto:ovalledor@gmail.com">Email</a></p>
        </div>
        <div class="view-footer">
          <span>Get in touch.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Shortcuts -->
      <div id="shortcuts-view" class="overlay-view">
        <div class="view-list">
          <p><span class="shortcut-key">1</span><span class="view-meta"> — Now</span></p>
          <p><span class="shortcut-key">2</span><span class="view-meta"> — Work</span></p>
          <p><span class="shortcut-key">3</span><span class="view-meta"> — About</span></p>
          <p><span class="shortcut-key">4</span><span class="view-meta"> — Essays</span></p>
          <p><span class="shortcut-key">5</span><span class="view-meta"> — Thoughts</span></p>
          <p><span class="shortcut-key">6</span><span class="view-meta"> — Books</span></p>
          <p><span class="shortcut-key">7</span><span class="view-meta"> — Music</span></p>
          <p><span class="shortcut-key">8</span><span class="view-meta"> — Links</span></p>
          <p><span class="shortcut-key">9</span><span class="view-meta"> — Contact</span></p>
          <p><span class="shortcut-key">M</span><span class="view-meta"> — Moon</span></p>
          <p><span class="shortcut-key">?</span><span class="view-meta"> — This panel</span></p>
          <p><span class="shortcut-key">Esc</span><span class="view-meta"> — Close</span></p>
        </div>
        <div class="view-footer">
          <span>Keyboard shortcuts</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Colophon -->
      <div id="colophon-view" class="overlay-view">
        <div class="view-list">
          <p>Built with HTML, CSS, and vanilla JavaScript.</p>
          <p>Typeset in Times New Roman.</p>
          <p>Hosted on GitHub Pages.</p>
          <p>Books synced from Goodreads.</p>
          <p>Adapts to your system's colour preference.</p>
          <p>Everything here is written by a human.</p>
          <p>Press <em>?</em> for keyboard shortcuts.</p>
        </div>
        <div class="view-footer">
          <span></span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Moon -->
      <div id="moon-view" class="overlay-view">
        <div class="view-list">
          <p id="moon-phase"></p>
          <p id="moon-detail" class="view-meta"></p>
        </div>
        <div class="view-footer">
          <span></span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Konami -->
      <div id="konami-view" class="overlay-view">
        <div class="view-list">
          <p>You found it.</p>
          <p>Most things worth finding aren't indexed.</p>
          <p>Keep looking.</p>
        </div>
        <div class="view-footer">
          <span></span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- About -->
      <div id="about-view" class="overlay-view">
        <div class="view-list">
          <p>I studied Business at UPF.</p>
          <p>I co-founded <a href="https://www.aceandtate.com" target="_blank" rel="noopener noreferrer">Project Lobster</a> when I was 23, which was acquired by <a href="https://www.aceandtate.com" target="_blank" rel="noopener noreferrer">Ace & Tate</a> 9 years later.</p>
          <p>I've been drawn to consumer products — digital and physical — for as long as I can remember. My curiosity has expanded to artificial intelligence, design, health, and science.</p>
          <p>I believe good design makes societies more intelligent. I try to apply it to everything.</p>
          <p>Taste is important. I believe you hone your taste by reading, travelling, listening, and experiencing life. Art, in any shape and form, is essential in training the eye.</p>
          <p>Physical wellbeing is important in living a good life. I lift weights five days a week, practice yoga and meditation, and optimise around sleep. I've been sober for four years — one of the best decisions I've ever made.</p>
        </div>
        <div class="view-footer">
          <span>Barcelona, 1994.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Music -->
      <div id="music-view" class="overlay-view">
        <div class="view-list"></div>
        <div class="view-footer">
          <span>Worth listening to.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Links -->
      <div id="links-view" class="overlay-view">
        <div class="view-list">
          <p><a href="https://fs.blog" target="_blank" rel="noopener noreferrer">Farnam Street</a><span class="view-meta"> — Clear thinking and decision-making</span></p>
          <p><a href="https://patrickcollison.com" target="_blank" rel="noopener noreferrer">Patrick Collison</a><span class="view-meta"> — Bookmarks, questions, and fast</span></p>
          <p><a href="https://paulgraham.com" target="_blank" rel="noopener noreferrer">Paul Graham</a><span class="view-meta"> — Essays on startups and life</span></p>
          <p><a href="https://www.ribbonfarm.com" target="_blank" rel="noopener noreferrer">Ribbonfarm</a><span class="view-meta"> — Longform thinking</span></p>
          <p><a href="https://sive.rs" target="_blank" rel="noopener noreferrer">Derek Sivers</a><span class="view-meta"> — Short, useful ideas</span></p>
          <p><a href="https://nav.al/" target="_blank" rel="noopener noreferrer">Naval Ravikant</a><span class="view-meta"> — Wealth, happiness, and philosophy</span></p>
          <p><a href="https://www.youtube.com/@veritasium" target="_blank" rel="noopener noreferrer">Veritasium</a><span class="view-meta"> — Science and engineering</span></p>
          <p><a href="https://www.youtube.com/@SabineHossenfelder" target="_blank" rel="noopener noreferrer">Sabine Hossenfelder</a><span class="view-meta"> — Physics without the hype</span></p>
        </div>
        <div class="view-footer">
          <span>Worth bookmarking.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Thoughts -->
      <div id="thoughts-view" class="overlay-view">
        <div class="view-list"></div>
        <div class="view-footer">
          <span>Short form.</span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

      <!-- Now -->
      <div id="now-view" class="overlay-view" data-updated="2026-02-26">
        <div class="now-body">
          <div class="view-list">
            <p>Based in Barcelona.<br>
            Interested in consumer, artificial intelligence &amp; health.</p>
            <p>Exploratory phase. <em>Planting seeds.</em></p>
          </div>
          <img src="tree.png" class="now-tree" alt="" aria-hidden="true">
        </div>
        <div class="view-footer">
          <span id="now-updated"></span>
          <nav><a href="#" class="view-close">Close</a></nav>
        </div>
      </div>

    </div>

  <script src="present.js"></script>
  <script>
    const page = document.querySelector('.page');

    // — Page fade-in —
    setTimeout(function() { page.classList.add('is-ready'); }, 100);

    // — View system —
    const viewTitleEl = document.querySelector('.view-title');
    const viewTitleMap = {
      books: 'Books', projects: 'Work', essays: 'Essays', now: 'Now',
      contact: 'Contact', about: 'About', music: 'Music', links: 'Links',
      thoughts: 'Thoughts', colophon: 'Colophon', shortcuts: 'Shortcuts',
      moon: 'Moon', konami: '✦'
    };

    function openView(name) {
      if (page.dataset.view === name) { closeView(); return; }
      // Pre-load data before showing the view so stagger delays are set before CSS transition triggers
      loadView(name).then(function() {
        staggerView(name);
        viewTitleEl.textContent = viewTitleMap[name] || name;
        page.dataset.view = name;
      });
    }

    function staggerView(name) {
      const overlay = document.getElementById(name + '-view');
      if (!overlay) return;
      const list = overlay.querySelector('.view-list');
      if (!list) return;
      const items = list.children;
      for (let i = 0; i < items.length; i++) {
        items[i].style.transitionDelay = (i * 50) + 'ms';
      }
    }

    function closeView() {
      const viewName = page.dataset.view;
      if (viewName) {
        const overlay = document.getElementById(viewName + '-view');
        if (overlay) {
          const items = overlay.querySelector('.view-list').children;
          for (let i = 0; i < items.length; i++) {
            items[i].style.transitionDelay = '';
          }
        }
      }
      delete page.dataset.view;
      viewTitleEl.textContent = '';
    }

    document.querySelectorAll('[data-view]').forEach(el => {
      if (el.tagName === 'A') {
        el.addEventListener('click', function(e) {
          e.preventDefault();
          openView(this.dataset.view);
        });
      }
    });

    document.querySelectorAll('.view-close').forEach(el => {
      el.addEventListener('click', function(e) {
        e.preventDefault();
        closeView();
      });
    });

    // — Tab title clock —
    let titleTimer = null;
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        function tickTitle() {
          const now = new Date();
          document.title = [
            String(now.getHours()).padStart(2, '0'),
            String(now.getMinutes()).padStart(2, '0'),
            String(now.getSeconds()).padStart(2, '0'),
          ].join(':');
        }
        tickTitle();
        titleTimer = setInterval(tickTitle, 1000);
      } else {
        clearInterval(titleTimer);
        document.title = 'Architecture of Ideas';
      }
    });

    // — Hello easter egg —
    function triggerHello() {
      if (document.querySelector('.hello-flash')) return;
      const el = document.createElement('div');
      el.className = 'hello-flash';
      el.textContent = 'hola.';
      document.body.appendChild(el);
      requestAnimationFrame(function() { el.classList.add('is-visible'); });
      setTimeout(function() {
        el.classList.remove('is-visible');
        setTimeout(function() { el.remove(); }, 600);
      }, 2500);
    }

    // — Konami code —
    const konamiSeq = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
    let konamiPos = 0;

    // — Keyboard shortcuts —
    let typedBuffer = '';
    document.addEventListener('keydown', function(e) {
      if (e.metaKey || e.ctrlKey || e.altKey) return;
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

      // Konami (works regardless of open view)
      if (e.key === konamiSeq[konamiPos]) {
        konamiPos++;
        if (konamiPos === konamiSeq.length) {
          konamiPos = 0;
          openView('konami');
          return;
        }
      } else {
        konamiPos = e.key === konamiSeq[0] ? 1 : 0;
      }

      if (e.key === 'Escape') { closeView(); return; }
      if (e.key === '?') {
        page.dataset.view === 'shortcuts' ? closeView() : openView('shortcuts');
        return;
      }
      if (page.dataset.view) return;

      // Hello detection
      if (e.key.length === 1) {
        typedBuffer = (typedBuffer + e.key).slice(-10);
        if (typedBuffer.toLowerCase().includes('hola')) {
          typedBuffer = '';
          triggerHello();
          return;
        }
      }

      const shortcuts = {
        '1': 'now', '2': 'projects', '3': 'about',
        '4': 'essays', '5': 'thoughts', '6': 'books',
        '7': 'music', '8': 'links', '9': 'contact',
        m: 'moon'
      };
      const view = shortcuts[e.key.toLowerCase()];
      if (view) openView(view);
    });

    // — Books —
    let booksData = null;

    async function loadBooks() {
      if (booksData) return booksData;
      const res = await fetch('books.json');
      booksData = await res.json();
      return booksData;
    }

    function renderBooks(data) {
      const list = document.querySelector('#books-view .view-list');
      list.innerHTML = '';

      const sections = [
        { label: 'Currently reading', items: data.currentlyReading },
        { label: null, items: data.read },
      ];

      for (const section of sections) {
        if (!section.items.length) continue;
        if (section.label) {
          const label = document.createElement('p');
          label.className = 'view-label';
          label.textContent = section.label;
          list.appendChild(label);
        }
        for (const book of section.items) {
          const p = document.createElement('p');
          const a = document.createElement('a');
          a.href = book.url;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          a.textContent = `${book.title} — ${book.author}`;
          p.appendChild(a);
          list.appendChild(p);
        }
      }

      const count = data.read.length;
      document.getElementById('books-count').textContent = count;
    }

    // — Projects —
    let projectsData = null;

    async function loadProjects() {
      if (projectsData) return projectsData;
      const res = await fetch('projects.json');
      projectsData = await res.json();
      return projectsData;
    }

    function renderProjects(data) {
      const list = document.querySelector('#projects-view .view-list');
      list.innerHTML = '';
      for (const project of data.projects.filter(p => !p.hidden)) {
        const p = document.createElement('p');

        if (project.url) {
          const a = document.createElement('a');
          a.href = project.url;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          a.textContent = project.title;
          p.appendChild(a);
        } else {
          p.appendChild(document.createTextNode(project.title));
        }

        if (project.status) {
          const span = document.createElement('span');
          span.className = 'view-meta';
          span.textContent = ` — ${project.status}`;
          p.appendChild(span);
        }

        if (project.description) {
          p.appendChild(document.createElement('br'));
          const desc = document.createElement('span');
          desc.className = 'view-meta';
          desc.textContent = project.description;
          p.appendChild(desc);
        }

        list.appendChild(p);
      }
    }

    // — Writing —
    let essaysData = null;

    async function loadEssays() {
      if (essaysData) return essaysData;
      const res = await fetch('essays.json');
      essaysData = await res.json();
      return essaysData;
    }

    function renderEssays(data) {
      const list = document.querySelector('#essays-view .view-list');
      list.innerHTML = '';
      if (!data.posts.length) {
        const p = document.createElement('p');
        p.className = 'view-meta';
        p.textContent = 'Nothing published yet.';
        list.appendChild(p);
        return;
      }
      for (const post of data.posts) {
        const p = document.createElement('p');
        if (post.slug) {
          const a = document.createElement('a');
          a.href = `essays/${post.slug}.html`;
          a.textContent = post.title;
          p.appendChild(a);
        } else {
          p.appendChild(document.createTextNode(post.title));
        }
        const metaParts = [];
        if (post.author) metaParts.push(post.author);
        if (post.date) metaParts.push(post.date);
        if (metaParts.length) {
          const meta = document.createElement('span');
          meta.className = 'view-meta';
          meta.textContent = ` — ${metaParts.join(', ')}`;
          p.appendChild(meta);
        }
        list.appendChild(p);
      }
    }

    // — Music —
    let musicData = null;

    async function loadMusic() {
      if (musicData) return musicData;
      const res = await fetch('music.json');
      musicData = await res.json();
      return musicData;
    }

    function renderMusic(data) {
      const list = document.querySelector('#music-view .view-list');
      list.innerHTML = '';

      const sections = [
        { label: 'Playlists', items: data.playlists, format: p => p.title },
        { label: 'Albums', items: data.albums, format: a => `${a.title} — ${a.artist}` },
      ];

      for (const section of sections) {
        if (!section.items.length) continue;
        const label = document.createElement('p');
        label.className = 'view-label';
        label.textContent = section.label;
        list.appendChild(label);
        for (const item of section.items) {
          const p = document.createElement('p');
          const a = document.createElement('a');
          a.href = item.url;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          a.textContent = section.format(item);
          p.appendChild(a);
          list.appendChild(p);
        }
      }
    }

    // — Thoughts —
    let thoughtsData = null;

    async function loadThoughts() {
      if (thoughtsData) return thoughtsData;
      const res = await fetch('thoughts.json');
      thoughtsData = await res.json();
      return thoughtsData;
    }

    function renderThoughts(data) {
      const list = document.querySelector('#thoughts-view .view-list');
      list.innerHTML = '';
      const sorted = data.thoughts.slice().sort((a, b) => b.date.localeCompare(a.date));
      for (let i = 0; i < sorted.length; i++) {
        if (i > 0) {
          const sep = document.createElement('hr');
          sep.className = 'thought-separator';
          list.appendChild(sep);
        }
        const row = document.createElement('div');
        row.className = 'thought-row';
        const num = document.createElement('span');
        num.className = 'thought-number';
        num.textContent = String(i + 1).padStart(2, '0');
        const p = document.createElement('p');
        p.textContent = sorted[i].text;
        row.appendChild(num);
        row.appendChild(p);
        list.appendChild(row);
      }
    }

    // — Now —
    (function () {
      const d = new Date(document.getElementById('now-view').dataset.updated);
      const label = d.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
      document.getElementById('now-updated').textContent = `Last updated ${label}`;
    })();

    // — Moon —
    document.getElementById('present-moon').addEventListener('click', function() {
      openView('moon');
    });

    function renderMoon() {
      const knownNewMoon = new Date('2000-01-06T18:14:00Z');
      const lunarCycle = 29.53059;
      const elapsed = (Date.now() - knownNewMoon.getTime()) / 86400000;
      const dayInCycle = ((elapsed % lunarCycle) + lunarCycle) % lunarCycle;
      const phase = dayInCycle / lunarCycle;

      let phaseName;
      if (phase < 0.0625 || phase >= 0.9375) phaseName = 'New Moon';
      else if (phase < 0.1875) phaseName = 'Waxing Crescent';
      else if (phase < 0.3125) phaseName = 'First Quarter';
      else if (phase < 0.4375) phaseName = 'Waxing Gibbous';
      else if (phase < 0.5625) phaseName = 'Full Moon';
      else if (phase < 0.6875) phaseName = 'Waning Gibbous';
      else if (phase < 0.8125) phaseName = 'Last Quarter';
      else phaseName = 'Waning Crescent';

      const daysToFull = dayInCycle < 14.77 ? 14.77 - dayInCycle : lunarCycle - dayInCycle + 14.77;
      const daysToNew = lunarCycle - dayInCycle;

      document.getElementById('moon-phase').textContent = phaseName;
      document.getElementById('moon-detail').textContent =
        `Day ${Math.floor(dayInCycle) + 1} of 30 · Full moon in ${Math.ceil(daysToFull)} day${Math.ceil(daysToFull) === 1 ? '' : 's'} · New moon in ${Math.ceil(daysToNew)} days`;
    }

    // — Auto-open view from URL param (e.g. ?view=essays) —
    (function() {
      const v = new URLSearchParams(window.location.search).get('view');
      if (v) openView(v);
    })();

    async function loadView(name) {
      if (name === 'books') renderBooks(await loadBooks());
      else if (name === 'projects') renderProjects(await loadProjects());
      else if (name === 'essays') renderEssays(await loadEssays());
      else if (name === 'moon') renderMoon();
      else if (name === 'music') renderMusic(await loadMusic());
      else if (name === 'thoughts') renderThoughts(await loadThoughts());
    }

  </script>
  </body>
</html>
